# <mark style="background: #FF5582A6;">Description :</mark> 
this vulnerability is included in : Broken Access Control

این آسیب پذیری (تعریف نا امن اشیا) با اسکنر پیدا نمیشود و فقط دستی یا با برپ سوین قابل انجام
است
Burp Suite
# Examples :
1. Target : mysite.com
     این سایت مثال یک بخشی داشت برای تغییر پسورد به اسم
     mysite.com/change_pass
     وقتی این بخش را میزنیم یک بخشی به آدرس اضافه میشود
     mysite.com/change_pass/?nid=196
     ممکن است اگر عدد جلوی مساوی را عوض کنیم، بشه پسورد کاربر دیگه ای را عوض کرد، وقتی پسورد را عوض کردیم ما را هدایت میکند به داخل صفحه ای به اسم
     mystite.com/change_pass/mydashboard
     ما فکر میکنیم که اگر همون پارامتر از علامت سوال تا عدد را جلوی مای داشبورد بذاریم چه میشود
     mystite.com/change_pass/mydashboard?nid=1
     در نتیجه اطلاعات حساب کاربری شخص دیگری را میبینیم وحتی ممکن است با برپ سوییت بشود ایمیل آن حساب هم عوض کرد
     Burp Suite
     در چنین حالتی وقتی ایمیل کاربر را عوض کردیم، با انجام عملیات فراموشی رمز در حالی که ایمیل او را عوض کردیم، به حساب آن شخص وارد میشویم

2. Target : site.com
    در سایت مثال مسیری وجود داشت به اسم
    site.com/forget-password
    در کادر فراموشی رمز ایمیل خود را وارد میکنیم و با برپ سویت آنالیزش میکنیم
    pedram@gmail.com
    در برپ سوییت میبینیم در چنین لحظه ای پارامتری تعریف شده به اسم
    email=pedram@gmail.com
    حالا امتحان میکنیم ببینیم که علاوه بر ایمیل ما اگر در برپ سوییت ایمیل دیگری استفاده کنیم ، به آن ایمیل هم درخواست فراموشی رمز ارسال میشود یا خیر ؟
    به این صورت
    email=pedram@gmail.com=parnia@gmail.com
    اگر ارسال شود به راحتی میشود فراموشی رمز را برای ایمیل دوم که تارگت ما میباشد اعمال کنیم و به حسابش وارد شویم
    
    برای گرفتن بانتی حتما لازم نیست ایمیل یکی از کاربران را پیدا کرد، ما دو تا ایمیل میسازیم به اسم هکر و تارگت و کافی است ثابت کنیم که با هکر میشود به تارگت دسترسی پیدا کرد

3. یک حساب در یک سایتی میسازیم ---> وارد حسابمون میشیم ---> برپ سویت را روشن میکنیم ---> آدرس اصلی سایت را تایپ میکنیم ---> در ریکوئست برپ ممکن است یوزر آیدی و یوزر ایمیل ببینیم، با عوض کردن یوزر آیدی خودمان ---> فروارد برپ را تند تند میزنیم ونتیجه ممکن است حساب کاربری شخص دیگری باشد البته قبل از وارد شدن به حساب برپ سویت را خاموش میکنیم

4. هکر یک حساب ساخته ---> به قسمت فراموشی رمز میرود و ایمیلش را وارد میکند ---> رمزی 
 که برایش ارسال شده (احراز هویت) را کپی میکندو و در کادر مورد نظر وارد میکند (تا اینجا همه چیز عادی است) ---> سپس پسورد جدید را در کادر وارد میکنیم، البته قبل از تایید کردن برپ را روشن میکنیم و سپس تایید را میزنیم ---> در برپ سوییت مینویسد
 email=hackers email & password=new password
 هکر جای ایمیل خود در برپ سویت، ایمیل دیگری که ساخته است را مینویسد ---> پس پسورد آپدیت میشود البته نه برای ایمیل هکر بلکه برای ایمیل دوم که ایمیل تارگت هم میتواند باشد

5. هکر یک حساب در سایتی ساخته است ---> به جای فراموشی رمز به قسمت ساخت حساب جدید میرود ---> ایمیلدوم خود را مینویسد و با پیام ایمیل را تایید کنید رو به رو میشود ---> ایمیلی که برایش فرستاده شده را تایید میکند و تا اینجا همه چیز عادی است ---> در قسمت وارد کردن پسورد، اول برپ سویت را روشن میکند و سپس ست پسورد را میزنیم ---> حال در برپ سوییت به دنبال دستور مورد نظر میگردیم بعد از پیام : ثبت نام با موفقیت انجام شد ---> وقتی قسمت ست پسورد پیدا شد ---> کدها را به ریپیتر برپ سویت میفرستد و در جایی که یوزر و پسورد و ایمیل مشخص است ---> به جای ایمیلی که با آن حساب ساخته شده است یعنی ایمیل دوم خود ---> ایمیل اصلی خود یعنی ایمیل اولش که قبلا با آن حساب ساخته است را وارد میکند ---> به این ترتیب پسورد ایمیل اول هکر که میتوانست ایمیل تارگت باشد عوض شده است و میتواند به حساب آن وارد شود

6. هکر با ایمیل اصلی خود حسابی در یک سایتی ساخته است ---> به قسمت ساخت حساب جدید وارد میشود و برای ثبت نام دوباره همان ایمیل اصلی خود را میدهد و خب با پیام : با این ایمیل قبلا حسابی ساخته شده است رو به رو میشود ---> برپ سویت را روشن میکند و دوباره همان درخواست را میدهد ---> البته که میداند اگر باز هم پیش برود با پیام گذشته رو به رو میشود پس کلیک راست میکند و گزینه ی
    Do intercept ---> Response to this request
    را انتخاب میکنیم ---> کر این گزینه در برپ سویت این است که پاسخی که قرار است به سرور ارسال شود را اول هکر ببیند و اگر صلاح دونست برای مرورگر ارسال کند ---> پاسخ سرور چیست ؟
    409 conflict
    یعنی این داده تکراری است
    (ارورهایی که با 4 شروع میشوند معنی نشدن میدهند)
    هکر ارور را در برپ سوییت پاک میکند یعنی ارور 409 و به جای آن 200 میگذارد که به معنی اوکی بودن و بدون مشکل بودن است و همچنین هکر پیام خطا هم پاک میکند یعنی به مرورگزر میگوید همه چی درست است و به این ترتیب میتواند وارد حساب اصلی خود که این حساب تارگت نیز میتواند باشد، وارد شود
    